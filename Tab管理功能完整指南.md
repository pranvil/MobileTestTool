# Tabç®¡ç†åŠŸèƒ½å®Œæ•´æŒ‡å—

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

Tabç®¡ç†åŠŸèƒ½ä¸ºæ‰‹æœºæµ‹è¯•è¾…åŠ©å·¥å…·æä¾›äº†ä¸‰ä¸ªé‡è¦çš„ç®¡ç†èƒ½åŠ›ï¼š

1. **Tabæ‹–æ‹½æ’åº** - ç”¨æˆ·å¯ä»¥é€šè¿‡æ‹–æ‹½æ¥è°ƒæ•´Tabçš„é¡ºåº
2. **Tabæ˜¾ç¤º/éšè—** - ç”¨æˆ·å¯ä»¥éšè—ä¸éœ€è¦çš„Tab
3. **è‡ªå®šä¹‰Tabå’ŒCard** - ç”¨æˆ·å¯ä»¥åˆ›å»ºè‡ªå·±çš„Tabå’ŒCard

## ğŸš€ åŠŸèƒ½è¯¦ç»†è¯´æ˜

### 1. Tabæ‹–æ‹½æ’åº

- **å¯ç”¨æ–¹å¼**: è‡ªåŠ¨å¯ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®
- **ä½¿ç”¨æ–¹æ³•**: ç›´æ¥æ‹–æ‹½Tabæ ‡é¢˜å³å¯è°ƒæ•´é¡ºåº
- **ä¿å­˜æœºåˆ¶**: æ‹–æ‹½åè‡ªåŠ¨ä¿å­˜æ–°çš„é¡ºåºåˆ°é…ç½®æ–‡ä»¶
- **é…ç½®æ–‡ä»¶**: `~/.netui/tab_config.json`

### 2. Tabæ˜¾ç¤º/éšè—

- **è®¿é—®æ–¹å¼**: åœ¨"å…¶ä»–"Tabä¸­ç‚¹å‡»"ğŸ“‹ Tabç®¡ç†"æŒ‰é’®
- **åŠŸèƒ½ä½ç½®**: Tabç®¡ç†å¯¹è¯æ¡† -> "Tabæ’åºå’Œæ˜¾ç¤º"æ ‡ç­¾é¡µ
- **ä½¿ç”¨æ–¹æ³•**: 
  - å‹¾é€‰/å–æ¶ˆå‹¾é€‰Tabåç§°å‰çš„å¤é€‰æ¡†æ¥æ§åˆ¶æ˜¾ç¤º/éšè—
  - ç‚¹å‡»"ä¿å­˜"æŒ‰é’®åº”ç”¨æ›´æ”¹
- **å³æ—¶ç”Ÿæ•ˆ**: ä¿å­˜åç«‹å³é‡æ–°åŠ è½½Tabå¸ƒå±€

### 3. è‡ªå®šä¹‰Tabå’ŒCard

#### è‡ªå®šä¹‰TabåŠŸèƒ½

- **åˆ›å»ºæ–¹å¼**: Tabç®¡ç†å¯¹è¯æ¡† -> "è‡ªå®šä¹‰Tab"æ ‡ç­¾é¡µ -> "æ·»åŠ Tab"
- **é…ç½®é¡¹**:
  - Tabåç§°
  - æè¿°ä¿¡æ¯
  - åŒ…å«çš„Cardåˆ—è¡¨
- **ç®¡ç†åŠŸèƒ½**:
  - ç¼–è¾‘ç°æœ‰Tab
  - åˆ é™¤ä¸éœ€è¦çš„Tab

#### è‡ªå®šä¹‰CardåŠŸèƒ½

- **åˆ›å»ºæ–¹å¼**: Tabç®¡ç†å¯¹è¯æ¡† -> "è‡ªå®šä¹‰Card"æ ‡ç­¾é¡µ -> "æ·»åŠ Card"
- **é…ç½®é¡¹**:
  - Cardåç§°
  - æè¿°ä¿¡æ¯
  - æ‰€å±Tab
  - æŒ‰é’®åˆ—è¡¨ï¼ˆå¯æ‰©å±•ï¼‰
- **ç®¡ç†åŠŸèƒ½**:
  - ç¼–è¾‘ç°æœ‰Card
  - åˆ é™¤ä¸éœ€è¦çš„Card

## ğŸ”§ æŠ€æœ¯å®ç°

### æ–°å¢æ–‡ä»¶

1. **core/tab_config_manager.py** - Tabé…ç½®ç®¡ç†å™¨
   - è´Ÿè´£Tabé…ç½®çš„ä¿å­˜å’ŒåŠ è½½
   - æ”¯æŒè‡ªå®šä¹‰Tabå’ŒCardçš„CRUDæ“ä½œ
   - æä¾›é…ç½®éªŒè¯å’Œé»˜è®¤å€¼å¤„ç†

2. **ui/tab_manager_dialog.py** - Tabç®¡ç†å¯¹è¯æ¡†
   - æä¾›Tabæ’åºå’Œæ˜¾ç¤ºæ§åˆ¶ç•Œé¢
   - æä¾›è‡ªå®šä¹‰Tabå’ŒCardçš„ç¼–è¾‘ç•Œé¢
   - æ”¯æŒé…ç½®çš„å¯¼å…¥å¯¼å‡ºåŠŸèƒ½

### ä¿®æ”¹æ–‡ä»¶

1. **ui/main_window.py** - ä¸»çª—å£
   - é›†æˆTabé…ç½®ç®¡ç†å™¨
   - å¯ç”¨Tabæ‹–æ‹½åŠŸèƒ½
   - å®ç°åŠ¨æ€TabåŠ è½½å’Œé‡æ–°åŠ è½½
   - æ·»åŠ Tabç®¡ç†å¯¹è¯æ¡†è°ƒç”¨

2. **ui/tabs/other_tab.py** - å…¶ä»–Tab
   - æ·»åŠ "ğŸ“‹ Tabç®¡ç†"æŒ‰é’®
   - æ”¯æŒè¯­è¨€åˆ‡æ¢æ—¶çš„æ–‡æœ¬åˆ·æ–°

## ğŸ“ é…ç½®æ–‡ä»¶æ ¼å¼

Tabé…ç½®ä¿å­˜åœ¨ `~/.netui/tab_config.json` æ–‡ä»¶ä¸­ï¼š

```json
{
  "tab_order": ["log_control", "log_filter", "network_info", ...],
  "tab_visibility": {
    "log_control": true,
    "log_filter": true,
    "network_info": false,
    ...
  },
  "custom_tabs": [
    {
      "id": "custom_001",
      "name": "è‡ªå®šä¹‰Tab",
      "description": "æè¿°ä¿¡æ¯",
      "cards": [],
      "created_time": "2024-01-01T00:00:00",
      "visible": true
    }
  ],
  "custom_cards": [
    {
      "id": "card_001",
      "name": "è‡ªå®šä¹‰Card",
      "description": "æè¿°ä¿¡æ¯",
      "tab_id": "custom_001",
      "buttons": [],
      "created_time": "2024-01-01T00:00:00"
    }
  ],
  "version": "1.0",
  "last_updated": "2024-01-01T00:00:00"
}
```

## ğŸ¯ ä½¿ç”¨æµç¨‹

### åŸºæœ¬ä½¿ç”¨

1. **è°ƒæ•´Tabé¡ºåº**: ç›´æ¥æ‹–æ‹½Tabæ ‡é¢˜
2. **éšè—Tab**: 
   - ç‚¹å‡»"å…¶ä»–"Tabä¸­çš„"ğŸ“‹ Tabç®¡ç†"
   - åœ¨"Tabæ’åºå’Œæ˜¾ç¤º"ä¸­å–æ¶ˆå‹¾é€‰ä¸éœ€è¦çš„Tab
   - ç‚¹å‡»"ä¿å­˜"

### é«˜çº§ä½¿ç”¨

1. **åˆ›å»ºè‡ªå®šä¹‰Tab**:
   - æ‰“å¼€Tabç®¡ç†å¯¹è¯æ¡†
   - åˆ‡æ¢åˆ°"è‡ªå®šä¹‰Tab"æ ‡ç­¾é¡µ
   - ç‚¹å‡»"æ·»åŠ Tab"
   - å¡«å†™Tabä¿¡æ¯å¹¶ä¿å­˜

2. **åˆ›å»ºè‡ªå®šä¹‰Card**:
   - åœ¨Tabç®¡ç†å¯¹è¯æ¡†ä¸­åˆ‡æ¢åˆ°"è‡ªå®šä¹‰Card"æ ‡ç­¾é¡µ
   - ç‚¹å‡»"æ·»åŠ Card"
   - é€‰æ‹©æ‰€å±Tabå¹¶å¡«å†™Cardä¿¡æ¯
   - ä¿å­˜é…ç½®

## ğŸ› é—®é¢˜ä¿®å¤è®°å½•

### 1. Tabå†…å®¹é”™ä½é—®é¢˜ä¿®å¤

**é—®é¢˜æè¿°**: éšè—Tabåï¼Œé€€å‡ºç¨‹åºé‡æ–°æ‰“å¼€ï¼ŒTabçš„åç§°æ˜¾ç¤ºä¸æ­£ç¡®ï¼Œå¹¶ä¸”å†…å®¹ä¹Ÿé”™ä½äº†ã€‚

**è§£å†³æ–¹æ¡ˆ**: ä¸ºæ¯ä¸ªTabå®ä¾‹æ·»åŠ `tab_id`å±æ€§ï¼Œç¡®ä¿Tabå®ä¾‹æ­£ç¡®è¯†åˆ«ã€‚

**ä¿®å¤æ•ˆæœ**:
- âœ… Tabå†…å®¹æ­£ç¡®: Tabåç§°å’Œå†…å®¹å®Œå…¨åŒ¹é…
- âœ… Tabé¡ºåºæ­£ç¡®: Tabæ‹–æ‹½æ’åºåŠŸèƒ½æ­£å¸¸å·¥ä½œ
- âœ… é…ç½®ä¿å­˜æ­£ç¡®: Tabéšè—/æ˜¾ç¤ºé…ç½®æ­£ç¡®ä¿å­˜å’ŒåŠ è½½
- âœ… é‡å¯åæ­£å¸¸: ç¨‹åºé‡å¯åTabçŠ¶æ€å®Œå…¨æ­£ç¡®

### 2. Tabéšè—åŠŸèƒ½æ˜¾ç¤ºæ–‡å­—é—®é¢˜ä¿®å¤

**é—®é¢˜æè¿°**: éšè—Tabåï¼ŒTabæ˜¾ç¤ºçš„æ–‡å­—ä¸æ­£ç¡®ï¼Œæ˜¾ç¤ºäº†é”™è¯¯çš„å†…å®¹æ ‡ç­¾ã€‚

**è§£å†³æ–¹æ¡ˆ**: ä¿®å¤Tabæ ‡é¢˜æ˜ å°„é€»è¾‘å’Œåˆå§‹åŒ–é—®é¢˜ã€‚

**ä¿®å¤æ•ˆæœ**:
- âœ… Tabæ ‡é¢˜æ­£ç¡®æ˜¾ç¤º: éšè—Tabåï¼Œå‰©ä½™çš„Tabæ ‡é¢˜æ˜¾ç¤ºæ­£ç¡®
- âœ… ç¿»è¯‘åŠŸèƒ½æ­£å¸¸: Tabæ ‡é¢˜æ”¯æŒä¸­è‹±æ–‡åˆ‡æ¢
- âœ… é…ç½®ä¿å­˜ç¨³å®š: Tabéšè—/æ˜¾ç¤ºé…ç½®æ­£ç¡®ä¿å­˜å’ŒåŠ è½½

### 3. Tabéšè—åæŒ‰é’®ç‚¹å‡»å¤±æ•ˆé—®é¢˜ä¿®å¤

**é—®é¢˜æè¿°**: éšè—å‡ ä¸ªTabä¹‹åï¼Œå‰©ä½™Tabä¸Šçš„æ‰€æœ‰æŒ‰é’®ç‚¹å‡»éƒ½ä¸èµ·ä½œç”¨äº†ã€‚

**è§£å†³æ–¹æ¡ˆ**: åœ¨Tabé‡æ–°åŠ è½½åï¼Œé‡æ–°è¿æ¥æ‰€æœ‰Tabçš„ä¿¡å·æ§½ã€‚

**ä¿®å¤æ•ˆæœ**:
- âœ… æŒ‰é’®åŠŸèƒ½æ¢å¤: Tabéšè—åï¼Œå‰©ä½™Tabçš„æŒ‰é’®ç‚¹å‡»åŠŸèƒ½æ­£å¸¸
- âœ… ä¿¡å·è¿æ¥æ­£å¸¸: æ‰€æœ‰Tabçš„ä¿¡å·æ§½æ­£ç¡®é‡æ–°è¿æ¥
- âœ… åŠŸèƒ½å®Œæ•´: Tabç®¡ç†åŠŸèƒ½å®Œå…¨æ­£å¸¸ï¼Œæ— éœ€é‡å¯ç¨‹åº

### 4. Tabæ‹–æ‹½å¡é¡¿å’Œå´©æºƒé—®é¢˜ä¿®å¤

**é—®é¢˜æè¿°**: Tabæ‹–æ‹½æ—¶æ„Ÿè§‰å¡é¡¿ï¼Œå¤šæ¬¡æ‹–æ‹½åç¨‹åºå´©æºƒã€‚

**è§£å†³æ–¹æ¡ˆ**: å®ç°é˜²æŠ–æœºåˆ¶ï¼Œé¿å…æ‹–æ‹½è¿‡ç¨‹ä¸­é¢‘ç¹ä¿å­˜é…ç½®ã€‚

**ä¿®å¤æ•ˆæœ**:
- âœ… æµç•…æ‹–æ‹½: æ¶ˆé™¤æ‹–æ‹½æ—¶çš„å¡é¡¿æ„Ÿ
- âœ… ç¨³å®šè¿è¡Œ: é˜²æ­¢å¤šæ¬¡æ‹–æ‹½åå´©æºƒ
- âœ… æ€§èƒ½ä¼˜åŒ–: å‡å°‘é¢‘ç¹çš„æ–‡ä»¶I/Oæ“ä½œ

## âš™ï¸ æŠ€æœ¯ç»†èŠ‚

### Tab IDå±æ€§è®¾ç½®
ä¸ºæ‰€æœ‰é»˜è®¤Tabæ·»åŠ äº†`tab_id`å±æ€§ï¼š
- `log_control_tab.tab_id = 'log_control'`
- `log_filter_tab.tab_id = 'log_filter'`
- `network_info_tab.tab_id = 'network_info'`
- `tmo_cc_tab.tab_id = 'tmo_cc'`
- `tmo_echolocate_tab.tab_id = 'tmo_echolocate'`
- `background_data_tab.tab_id = 'background_data'`
- `app_operations_tab.tab_id = 'app_operations'`
- `other_tab.tab_id = 'other'`

### é˜²æŠ–æœºåˆ¶
```python
def _on_tab_moved(self, from_index, to_index):
    """Tabæ‹–æ‹½ç§»åŠ¨å¤„ç†"""
    # ä½¿ç”¨é˜²æŠ–æœºåˆ¶ï¼Œé¿å…é¢‘ç¹ä¿å­˜
    if hasattr(self, '_tab_move_timer'):
        self._tab_move_timer.stop()
    else:
        from PyQt5.QtCore import QTimer
        self._tab_move_timer = QTimer()
        self._tab_move_timer.setSingleShot(True)
        self._tab_move_timer.timeout.connect(self._save_tab_order)
    
    # å»¶è¿Ÿ500msä¿å­˜ï¼Œé¿å…æ‹–æ‹½è¿‡ç¨‹ä¸­é¢‘ç¹ä¿å­˜
    self._tab_move_timer.start(500)
```

### ä¿¡å·é‡è¿æœºåˆ¶
```python
def _reconnect_tab_signals(self):
    """é‡æ–°è¿æ¥Tabä¿¡å·æ§½"""
    try:
        # è¿æ¥ Logæ§åˆ¶ Tab ä¿¡å·
        if hasattr(self, 'log_control_tab'):
            self.log_control_tab.mtklog_start.connect(self._on_mtklog_start)
            self.log_control_tab.mtklog_stop_export.connect(self._on_mtklog_stop_export)
            # ... å…¶ä»–ä¿¡å·è¿æ¥
        
        logger.debug(self.tr("Tabä¿¡å·æ§½é‡æ–°è¿æ¥å®Œæˆ"))
        
    except Exception as e:
        logger.exception(f"{self.tr('é‡æ–°è¿æ¥Tabä¿¡å·æ§½å¤±è´¥:')} {e}")
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### æ—¥å¿—ç³»ç»Ÿä¼˜åŒ–
- **åˆ†ç¦»å…³æ³¨ç‚¹**: ç¿»è¯‘å¤±è´¥æ—¥å¿—ç‹¬ç«‹å­˜å‚¨
- **å‡å°‘å™ªéŸ³**: debugæ—¥å¿—ä¸“æ³¨äºé‡è¦é—®é¢˜
- **ä¿æŒå…¼å®¹**: å‘åå…¼å®¹ç°æœ‰æ—¥å¿—ç³»ç»Ÿ

### æ€§èƒ½æ”¹è¿›
- **é˜²æŠ–æœºåˆ¶**: é¿å…é¢‘ç¹çš„æ–‡ä»¶I/Oæ“ä½œ
- **å»¶è¿Ÿä¿å­˜**: æ‹–æ‹½å®Œæˆåæ‰ä¿å­˜é…ç½®
- **å¼‚å¸¸å¤„ç†**: å¢å¼ºé”™è¯¯å¤„ç†ï¼Œé˜²æ­¢å´©æºƒ

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é…ç½®å¤‡ä»½**: å»ºè®®å®šæœŸå¤‡ä»½ `~/.netui/tab_config.json` æ–‡ä»¶
2. **é‡ç½®åŠŸèƒ½**: å¯ä»¥ä½¿ç”¨"é‡ç½®ä¸ºé»˜è®¤"åŠŸèƒ½æ¢å¤åŸå§‹é…ç½®
3. **è‡ªå®šä¹‰Tab**: ç›®å‰è‡ªå®šä¹‰Tabä¸ºç®€å•å®ç°ï¼Œåç»­å¯ä»¥æ‰©å±•ä¸ºå®Œæ•´çš„åŠ¨æ€UIç”Ÿæˆ
4. **å…¼å®¹æ€§**: æ–°åŠŸèƒ½å‘åå…¼å®¹ï¼Œä¸ä¼šå½±å“ç°æœ‰é…ç½®

## ğŸ”„ åç»­æ‰©å±•è®¡åˆ’

1. **åŠ¨æ€UIç”Ÿæˆ**: æ”¯æŒå®Œå…¨è‡ªå®šä¹‰çš„Tabå’ŒCardå¸ƒå±€
2. **æŒ‰é’®æ¨¡æ¿**: æä¾›å¸¸ç”¨æŒ‰é’®æ¨¡æ¿
3. **é…ç½®å¯¼å…¥å¯¼å‡º**: æ”¯æŒé…ç½®æ–‡ä»¶çš„å¯¼å…¥å¯¼å‡º
4. **ä¸»é¢˜æ”¯æŒ**: ä¸ºè‡ªå®šä¹‰Tabå’ŒCardæä¾›ä¸»é¢˜æ”¯æŒ

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹ä¸Šæ–¹çš„"é—®é¢˜ä¿®å¤è®°å½•"éƒ¨åˆ†
2. æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®
3. æŸ¥çœ‹ç¨‹åºæ—¥å¿—æ–‡ä»¶ï¼š`logs/debug_*.txt`
4. è”ç³»å¼€å‘å›¢é˜Ÿ

---

**æ€»ç»“**: Tabç®¡ç†åŠŸèƒ½ç°åœ¨å®Œå…¨ç¨³å®šï¼Œç”¨æˆ·å¯ä»¥äº«å—æµç•…çš„Tabæ‹–æ‹½ã€éšè—/æ˜¾ç¤ºå’Œè‡ªå®šä¹‰åŠŸèƒ½ï¼Œæ‰€æœ‰å·²çŸ¥é—®é¢˜éƒ½å·²ä¿®å¤ï¼ğŸ‰
